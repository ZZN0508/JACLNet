(()=>{var e;window,e={properties:{debug:!1,load:!1,running:!1,maxTries:10,delayTry:1e3,readyEvent:"readyAttribution",runEvent:"runAttribution",initEvent:"initAttribution",default:"Default",defaultCampaignId:"100000000",prodDomains:["www.outbrain.com","my.outbrain.com","careers.outbrain.com","lp.outbrain.com"],queryParams:["utm_medium","utm_source","utm_campaign","utm_term","utm_content","utm_position","utm_placement","utm_device","utm_network","utm_ad","inapp","gclid","adgroupid","matchtype","campaignid","keyword","os_utm_source","spreportid","spjobid","spuserid","spmailingid","b_id","page","domain","permalink"],cookie:{prefix:"obca",seporator:"_",path:"/",localhost:"localhost",default:"",expire:{permanent:342144e5,session:18e5,interval:15e5},cookies:{visitor:"vid",session:"sid",data:"data"}},old:{sep:"--s-e-p--",default:"Default",error:"Error",cookies:{medium:"obCAMedium",truemedium:"obCATrueMedium",source:"obCASource",campaign:"obCACampaign",content:"obCAContent",term:"obCATerm",landingpage:"obCALP",referral:"obCAReferral",current:"obCACP",session:"obCASession"}},mediumSources:{direct:"Direct",organic:"Organic",social:"Social",outbrain:"Outbrain",paidOutbrain:"Paid Outbrain",organicSeo:"Organic SEO",referral:"Generic Referral",organicBrand:"Organic Brand"},referralMedium:[{regex:/^(Default)?$/,medium:function(){return e.properties.mediumSources.direct}},{regex:/^(www\.google\.[a-zA-Z0-9\.]+|www\.bing\.com|search\.aol\.com|search\.yahoo\.com|www\.ask\.com|www\.baidu\.com|www\.yandex\.com|search\.conduit\.com|isearch\.avg\.com|isearch\.babylon\.com|search\.bt\.com|search\.centurylink\.com|search\.chatzum\.com|i?search\.nation\.com|search\.xfinity\.com|search\.gboxapp\.com|search\.genieo\.com|search\.iminent\.com|search\.incredibar\.com|(int\.)?search\.mywebsearch\.com|search\.naver\.com|search\.phpnuke\.org|search\.sweetim\.com)$/,medium:function(){return e.properties.mediumSources.organic}},{regex:/^(plancast\.com|www\.quora\.com|foursquare\.com|www\.youtube\.com|www\.stumbleupon\.com|plus\.google\.com|twitter\.com|www\.facebook\.com|www\.linkedin\.com|www\.pinterest\.com|www\.reddit\.com|www\.fark\.com)$/,medium:function(){return e.properties.mediumSources.social}},{regex:/^(paid\.outbrain\.com)$/,medium:function(){return e.properties.mediumSources.paidOutbrain}},{regex:/^(hellobiz\.fr|it\.toolbox\.com|www\.infos\.fr|www\.curata\.com|www\.happies\.fr|www\.shoutmeloud\.com|www\.convinceandconvert\.com|socialmediaweek\.org|www\.wordstream\.com|www\.jeffbullas\.com|www\.blogginpro\.com|www\.searchenginejournal\.com|searchenginewatch\.com|www\.business2community\.com|www\.socialmediatoday\.com|www\.problogger\.net)$/,medium:function(){return e.properties.mediumSources.organicSeo}},{regex:/^([a-zA-Z0-9\.\-\_]+\.)?outbrain.(com|cc|co\.jp|co\.uk|com\.au|com\.br|de|es|eu|fr|hk|in|is|it|kr|mx|org|sg|us)$/,medium:function(){return e.properties.mediumSources.outbrain}}],ignoreMedium:function(){return[e.properties.mediumSources.direct,e.properties.mediumSources.outbrain,e.properties.mediumSources.organicBrand]},homepageHosts:["www.outbrain.com","www-test.outbrain.com","www.outbrain.local"],interval:!1},functions:{event:{bind:function(e,t,r){window.addEventListener?e.addEventListener(t,r,!1):window.attachEvent?e.attachEvent("on"+t,r):e["on"+t]=r},trigger:function(e,t){var r;document.createEvent?(r=document.createEvent("HTMLEvents")).initEvent(t,!0,!0):document.createEventObject&&((r=document.createEventObject()).eventType=t),r.eventName=t,e.dispatchEvent?e.dispatchEvent(r):e.fireEvent&&htmlEvents["on"+t]?e.fireEvent("on"+r.eventType,r):e[t]?e[t]():e["on"+t]&&e["on"+t]()},unbind:function(e,t,r){window.removeEventListener?e.removeEventListener(t,r,!1):window.detachEvent?e.detachEvent("on"+t,r):e.delete("on"+t)}},query:{get:function(e){e=e.replace(/[\[\]]/g,"\\$&");var t=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(window.location.href);return!!t&&!!t[2]&&decodeURIComponent(t[2].replace(/\+/g," "))},set:function(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t.join("&")}},helpers:{log:function(t){e.properties.debug&&console.log(t)},isJson:function(e){if("[object Object]"===Object.prototype.toString.call(e))return!0;try{var t=JSON.parse(e);return"[object Object]"===Object.prototype.toString.call(t)}catch(e){return!1}},parseJson:function(t){return"[object Object]"===Object.prototype.toString.call(t)?t:!!e.functions.helpers.isJson(t)&&JSON.parse(t)},parseUrl:function(e){if(e){if(document&&document.createElement){var t=document.createElement("a");return t.href=e,{hash:t.hash,host:t.host,hostname:t.hostname,href:t.href,origin:t.origin,pathname:t.pathname,port:t.port,protocol:t.protocol,search:t.search}}var r=new RegExp("^https?://([^/]*).*$"),i=e.match(r);if(i.length>1)return{hostname:i[1]}}return{}},shortenUrl:function(t){if(!t)return t;if(-1===t.indexOf("?"))return t;var r=[];r.push(t.split("?")[0]),r.push(t.substring(t.indexOf("?")+1));for(var i=r[1].split("&"),n=[],o=0;o<i.length;o++){var s=-1===i[o].indexOf("=")?i[o]:i[o].split("=")[0],a=-1===i[o].indexOf("=")?"":i[o].substring(i[o].indexOf("=")+1);a&&e.properties.queryParams.indexOf(s.toLowerCase())>-1&&n.push(s+"="+a)}var u=r[0];return n.length>0&&(u+="?"+n.join("&")),u.length>200?u.substring(0,200)+"...":u},getAbsoluteHref:function(e){var t=document.createElement("a");return t.href=e,t.href},getServiceHostname:function(){var t="my2.outbrain.com";return-1!==e.properties.prodDomains.indexOf(window.location.hostname)&&(t="my.outbrain.com"),"https://"+t+"/site-tracking"},getDeviceType:function(){if(navigator&&navigator.userAgent){if(new RegExp("(mobile)|(iPhone)|(iPod)|(blackberry)|(windows phone)","i").test(navigator.userAgent))return"Mobile";if(new RegExp("(tablet)|(iPad)|(android)|(Bada)|(samsung)|(Kindle)","i").test(navigator.userAgent))return"Tablet";if(new RegExp("(windows nt)|(linux)|(os x)|(cros)","i").test(navigator.userAgent))return"Desktop"}return"Unknown"},ajaxRequest:function(t,r,i,n,o){o=o||0,i=i||"GET",n=e.functions.helpers.parseJson(n)||{};try{var s=window.XMLHttpRequest||window.ActiveXObject||!1;if(s){var a=new s("MSXML2.XMLHTTP.3.0");a.open(i,e.functions.helpers.getServiceHostname()+t,1),a.setRequestHeader("Content-Type","application/json"),a.onreadystatechange=function(){if(a.readyState>3&&r)if(200===a.status){var s=e.functions.helpers.parseJson(a.responseText);s?r(null,s):(e.functions.helpers.log({message:"Error: response not a json"}),o>e.properties.maxTries?("undefined"!=typeof _kmq&&_kmq.push(["record","",{attributionErrorName:"Error: response not a json",attributionErrorMessage:a.responseText,attributionErrorStatus:a.status,attributionErrorUrl:t,attributionErrorMethod:i,attributionErrorData:JSON.stringify(n)}]),r(new Error("Error: response not a json"))):(o++,setTimeout((function(){e.functions.helpers.ajaxRequest(t,r,i,n,o)}),e.properties.delayTry)))}else e.functions.helpers.log({message:"Error: response status not 200 on "+t}),o>e.properties.maxTries?("undefined"!=typeof _kmq&&_kmq.push(["record","Attribution Error",{attributionErrorName:"Response Status not 200",attributionErrorMessage:a.responseText,attributionErrorStatus:a.status,attributionErrorUrl:t,attributionErrorMethod:i,attributionErrorData:JSON.stringify(n)}]),r(new Error("Error: response status not 200 on "+t))):(o++,setTimeout((function(){e.functions.helpers.ajaxRequest(t,r,i,n,o)}),e.properties.delayTry))},a.send(JSON.stringify(n))}else e.functions.helpers.log({message:"Error: No Request"}),o>e.properties.maxTries?("undefined"!=typeof _kmq&&_kmq.push(["record","Attribution Error",{attributionErrorName:"No Request",attributionErrorMessage:"No Request",attributionErrorUrl:t,attributionErrorMethod:i,attributionErrorData:JSON.stringify(n)}]),r(new Error("Error: No Request"))):(o++,setTimeout((function(){e.functions.helpers.ajaxRequest(t,r,i,n,o)}),e.properties.delayTry))}catch(s){e.functions.helpers.log({message:"AJAX request error"}),o>e.properties.maxTries?("undefined"!=typeof _kmq&&_kmq.push(["record","Attribution Error",{attributionErrorName:s.name,attributionErrorMessage:s.message,attributionErrorUrl:t,attributionErrorMethod:i,attributionErrorData:JSON.stringify(n)}]),r(s)):(o++,setTimeout((function(){e.functions.helpers.ajaxRequest(t,r,i,n,o)}),e.properties.delayTry))}},attributionException:function(e,t){this.data=e||{},this.type=t||"event"},exception:function(t,r){throw new e.functions.helpers.attributionException(t,r)},refresh:function(t,r,i){window.OBAttributionTracking=window.OBAttributionTracking||{},window.OBAttributionTracking.properties=window.OBAttributionTracking.properties||{},window.OBAttributionTracking.properties.data=window.OBAttributionTracking.properties.data||{};var n=window.OBAttributionTracking.properties.data.current||document.referrer||e.properties.default;window.OBAttributionTracking=window.OBAttributionTracking||{},window.OBAttributionTracking.properties={},window.OBAttributionTracking.properties.vid=t,window.OBAttributionTracking.properties.sid=r,window.OBAttributionTracking.properties.data={},window.OBAttributionTracking.properties.data.previous=n,window.OBAttributionTracking.properties.data.current=i.current||e.properties.default,window.OBAttributionTracking.properties.data.landingpage=i.landingpage||e.properties.default,window.OBAttributionTracking.properties.data.referral=i.referral||e.properties.default,window.OBAttributionTracking.properties.data.medium=i.medium||e.properties.default,window.OBAttributionTracking.properties.data.truemedium=i.truemedium||e.properties.default,window.OBAttributionTracking.properties.data.source=i.source||e.properties.default,window.OBAttributionTracking.properties.data.campaign=i.campaign||e.properties.default,window.OBAttributionTracking.properties.data.campaignid=i.campaignid||e.properties.defaultCampaignId,window.OBAttributionTracking.properties.data.term=i.term||e.properties.default,window.OBAttributionTracking.properties.data.content=i.content||e.properties.default},event:function(t,r){(r=r||{}).generics=r.generics||{},r.generics.eventGroup=r.generics.eventGroup||"Marketing",r.generics.visitorId=window.OBAttributionTracking.properties.vid,r.generics.sessionId=window.OBAttributionTracking.properties.sid,r.generics.eventTypeId=r.generics.eventTypeId||100,r.generics.currentUrl=r.generics.currentUrl||window.OBAttributionTracking.properties.data.current,r.generics.previousUrl=r.generics.previousUrl||(e.properties.default===window.OBAttributionTracking.properties.data.previous?"":window.OBAttributionTracking.properties.data.previous),r.attributes=r.attributes||{},e.functions.helpers.ajaxRequest("/event",(function(e,r){!e&&r?t&&t(null,r):(e=e||"No EID was generated",t&&t(e))}),"POST",r)},kiss:function(t,r){"undefined"!=typeof _kmq&&(t=t||"New visit",(r=e.functions.helpers.parseJson(r)||{}).AT_Current_Page_URL=window.OBAttributionTracking.properties.data.current||e.properties.default,r.AT_Previous_Page_URL=window.OBAttributionTracking.properties.data.previous||e.properties.default,r.AT_Landing_Page_URL=window.OBAttributionTracking.properties.data.landingpage||e.properties.default,r.AT_Referral_URL=window.OBAttributionTracking.properties.data.referral||e.properties.default,r.AT_Medium=window.OBAttributionTracking.properties.data.medium||e.properties.default,r.AT_True_Medium=window.OBAttributionTracking.properties.data.truemedium||e.properties.default,r.AT_Source=window.OBAttributionTracking.properties.data.source||e.properties.default,r.AT_Campaign=window.OBAttributionTracking.properties.data.campaign||e.properties.default,r.AT_Campaign_Id=window.OBAttributionTracking.properties.data.campaignid||e.properties.defaultCampaignId,r.AT_Term=window.OBAttributionTracking.properties.data.term||e.properties.default,r.AT_Content=window.OBAttributionTracking.properties.data.content||e.properties.default,r.AT_Visit_Device=e.functions.helpers.getDeviceType(),_kmq.push(["record",t,r]))},gtm:function(t){"undefined"!=typeof dataLayer&&((t=e.functions.helpers.parseJson(t)||{}).event=t.event||"New visit",t.caCurrent=window.OBAttributionTracking.properties.data.current||e.properties.default,t.caPrevious=window.OBAttributionTracking.properties.data.previous||e.properties.default,t.caLandingpage=window.OBAttributionTracking.properties.data.landingpage||e.properties.default,t.caReferral=window.OBAttributionTracking.properties.data.referral||e.properties.default,t.caMedium=window.OBAttributionTracking.properties.data.medium||e.properties.default,t.caTruemedium=window.OBAttributionTracking.properties.data.truemedium||e.properties.default,t.caSource=window.OBAttributionTracking.properties.data.source||e.properties.default,t.caCmpaign=window.OBAttributionTracking.properties.data.campaign||e.properties.default,t.caCampaignid=window.OBAttributionTracking.properties.data.campaignid||e.properties.defaultCampaignId,t.caTerm=window.OBAttributionTracking.properties.data.term||e.properties.default,t.caContent=window.OBAttributionTracking.properties.data.content||e.properties.default,dataLayer.push(t))},old:function(){return{events:{visit:"New Visit",startRegistration:"Start Registration",completeRegistration:"Complete Registration"},recordEvent:function(t,r){(r=e.functions.helpers.parseJson(r)||{}).caCurrent=window.OBAttributionTracking.properties.data.current||e.properties.default,r.caPrevious=window.OBAttributionTracking.properties.data.previous||e.properties.default,r.caLandingpage=window.OBAttributionTracking.properties.data.landingpage||e.properties.default,r.caReferral=window.OBAttributionTracking.properties.data.referral||e.properties.default,r.caMedium=window.OBAttributionTracking.properties.data.medium||e.properties.default,r.caTruemedium=window.OBAttributionTracking.properties.data.truemedium||e.properties.default,r.caSource=window.OBAttributionTracking.properties.data.source||e.properties.default,r.caCmpaign=window.OBAttributionTracking.properties.data.campaign||e.properties.default,r.caCampaignid=window.OBAttributionTracking.properties.data.campaignid||e.properties.defaultCampaignId,r.caTerm=window.OBAttributionTracking.properties.data.term||e.properties.default,r.caContent=window.OBAttributionTracking.properties.data.content||e.properties.default,"undefined"!=typeof _kmq&&_kmq.push(["record",t,r])}}},store:function(t,r,i){window.OBAttributionTracking=window.OBAttributionTracking||{},window.OBAttributionTracking.exception=window.OBAttributionTracking.exception||e.functions.helpers.exception,e.functions.helpers.refresh(t,r,i),window.OBAttributionTracking.track=window.OBAttributionTracking.track||{},window.OBAttributionTracking.track.event=e.functions.helpers.event,window.OBAttributionTracking.track.kiss=e.functions.helpers.kiss,window.OBAttributionTracking.track.gtm=e.functions.helpers.gtm,window.OBCustomerAttribution=e.functions.helpers.old()}},cookies:{domain:function(){if(window&&window.location&&window.location.hostname){var t=window.location.hostname.split(".").reverse();if(t.length>1)return t[1]+"."+t[0]}return e.properties.cookie.localhost},name:function(t){return e.properties.cookie.prefix+e.properties.cookie.seporator+t},expire:function(e){var t=new Date;return t.setTime(t.getTime()+e),t.toUTCString()},get:function(e){for(var t=e+"=",r=document.cookie.split(";"),i=0;i<r.length;i++){for(var n=r[i];" "===n.charAt(0);)n=n.substring(1);if(0===n.indexOf(t))return decodeURIComponent(n.substring(t.length,n.length))}return!1},set:function(t,r,i){if(t){r=encodeURIComponent(r||""),(i=i||{}).path=i.path||e.properties.cookie.path,i.domain=i.domain||e.functions.cookies.domain();var n=t+"="+r;for(var o in i)i.hasOwnProperty(o)&&(n+="; "+o+"="+i[o]);document.cookie=n}},delete:function(t){e.functions.cookies.set(t,"",{expires:e.functions.cookies.expire(-1)})}},visitor:{fetch:function(t){e.functions.helpers.ajaxRequest("/visitor",(function(e,r){!e&&r&&r.uuid?t(null,r.uuid):t(e=e||"No VID was generated")}),"POST")},set:function(t){e.functions.cookies.set(e.functions.cookies.name(e.properties.cookie.cookies.visitor),t,{expires:e.functions.cookies.expire(e.properties.cookie.expire.permanent)})},get:function(){return e.functions.cookies.get(e.functions.cookies.name(e.properties.cookie.cookies.visitor))},createOrExtend:function(t){var r=e.functions.visitor.get();r?(e.functions.visitor.set(r),e.functions.helpers.log({message:"Visitor ID exists, extending cookie",data:{vid:r}}),t(null,r)):e.functions.visitor.fetch((function(r,i){r?t(r):(e.functions.visitor.set(i),e.functions.helpers.log({message:"Visitor ID Fetched, creating cookie",data:{vid:i}}),t(null,i))}))}},data:{isHomePage:function(){return e.properties.homepageHosts.indexOf(window.location.hostname)>-1&&"/"===window.location.pathname},mediumByReferral:function(){for(var t=e.functions.helpers.parseUrl(document.referrer).hostname||e.properties.default,r=0;r<e.properties.referralMedium.length;r++)if(e.properties.referralMedium[r].regex.test(t))return e.properties.referralMedium[r].medium()===e.properties.mediumSources.organic&&e.functions.data.isHomePage()?e.properties.mediumSources.organicBrand:e.properties.referralMedium[r].medium();return!1},truemedium:function(t,r){return r?t.truemedium||!1:e.functions.query.get("utm_medium")||e.functions.data.mediumByReferral()||e.properties.mediumSources.referral||!1},original:function(t,r){var i=e.functions.data.truemedium(t,r);return t.medium&&i!==t.medium&&-1!==e.properties.ignoreMedium().indexOf(i)},medium:function(t,r){return r||e.functions.data.original(t,r)?t.medium||!1:e.functions.query.get("utm_medium")||e.functions.data.mediumByReferral()||e.properties.mediumSources.referral||!1},source:function(t,r){return r||e.functions.data.original(t,r)?t.source||!1:e.functions.query.get("utm_source")||e.functions.helpers.parseUrl(document.referrer).hostname||!1},campaign:function(t,r){return r||e.functions.data.original(t,r)?t.campaign||!1:e.functions.data.medium(t,r)===e.properties.mediumSources.organicSeo?document.referrer||!1:e.functions.query.get("utm_campaign")},campaignid:function(t,r){var i=(e.functions.data.campaign(t,r)||"").split("--");if(i.length>0){var n=parseInt(i[0]);if(!isNaN(n)&&9===(n=n.toString()).length)return n}return!1},term:function(t,r){return r||e.functions.data.original(t,r)?t.term||!1:e.functions.query.get("utm_term")},content:function(t,r){return r||e.functions.data.original(t,r)?t.content||!1:e.functions.query.get("utm_content")},referral:function(e,t){return t?e.referral||!1:document.referrer||!1},current:function(e){return e||window.location.href||!1},landingpage:function(e,t){return t?e.landingpage||!1:window.location.href||!1}},attribution:{set:function(t){if(e.functions.helpers.isJson(t)){for(var r in t)t.hasOwnProperty(r)&&!t[r]&&delete t[r];e.functions.cookies.set(e.functions.cookies.name(e.properties.cookie.cookies.data),JSON.stringify(t),{expires:e.functions.cookies.expire(e.properties.cookie.expire.permanent)})}return t},get:function(){return e.functions.helpers.parseJson(e.functions.cookies.get(e.functions.cookies.name(e.properties.cookie.cookies.data)))},session:function(){var t=e.functions.session.get();return t?(e.functions.helpers.log({message:"Session is active",data:{sid:t}}),!0):(e.functions.helpers.log({message:"No Session"}),!1)},calculate:function(t,r,i){var n={};return n.current=e.functions.helpers.shortenUrl(e.functions.data.current(i)),e.functions.helpers.log({message:"current",url:n.current}),n.referral=e.functions.helpers.shortenUrl(e.functions.data.referral(t,r)),e.functions.helpers.log({message:"referral",url:n.referral}),n.landingpage=e.functions.helpers.shortenUrl(e.functions.data.landingpage(t,r)),e.functions.helpers.log({message:"landingpage",url:n.landingpage}),n.medium=e.functions.data.medium(t,r),n.truemedium=e.functions.data.truemedium(t,r),n.source=e.functions.data.source(t,r),n.campaign=e.functions.data.campaign(t,r),n.campaignid=e.functions.data.campaignid(t,r),n.content=e.functions.data.content(t,r),n.term=e.functions.data.term(t,r),n}},session:{fetch:function(t,r,i){e.functions.helpers.ajaxRequest("/session",(function(e,t){!e&&t&&t.uuid?i(null,t.uuid):i(e=e||"No SID was generated")}),"POST",{visitor_id:t,ca_medium:r.medium||e.properties.default,ca_true_medium:r.truemedium||e.properties.default,ca_source:r.source||e.properties.default,ca_campaign:r.campaign||e.properties.default,ca_campaign_id:r.campaignid||e.properties.defaultCampaignId,ca_campaign_content:r.content||e.properties.default,ca_campaign_term:r.term||e.properties.default,ca_referring_url:r.referral||e.properties.default,ca_landing_page_url:r.landingpage||e.properties.default})},set:function(t){e.functions.cookies.set(e.functions.cookies.name(e.properties.cookie.cookies.session),t,{expires:e.functions.cookies.expire(e.properties.cookie.expire.session)})},get:function(){return e.functions.cookies.get(e.functions.cookies.name(e.properties.cookie.cookies.session))},createOrExtend:function(t,r,i){var n=e.functions.session.get();n?(e.functions.session.set(n),r=e.functions.attribution.set(r),e.functions.helpers.log({message:"Session ID exists, extending cookie",sid:n,data:r}),i(null,n)):e.functions.session.fetch(t,r,(function(t,n){t?i(t):(e.functions.session.set(n),r=e.functions.attribution.set(r),e.functions.helpers.log({message:"Session ID generated",data:{sid:n,data:r}}),i(null,n,!0))}))}},old:{set:function(){for(var t in e.properties.old.cookies)e.properties.old.cookies.hasOwnProperty(t)&&e.functions.cookies.delete(e.properties.old.cookies[t])},value:function(t){if(t){var r=t.split(e.properties.old.sep);if(r.length>0&&r[0]!==e.properties.old.default&&r[0]!==e.properties.old.error)return decodeURIComponent(r[0])}return!1},get:function(){var t={};return t.medium=e.functions.old.value(e.functions.cookies.get(e.properties.old.cookies.medium)),t.truemedium=e.functions.old.value(e.functions.cookies.get(e.properties.old.cookies.truemedium)),t.source=e.functions.old.value(e.functions.cookies.get(e.properties.old.cookies.source)),t.campaign=e.functions.old.value(e.functions.cookies.get(e.properties.old.cookies.campaign)),t.content=e.functions.old.value(e.functions.cookies.get(e.properties.old.cookies.content)),t.term=e.functions.old.value(e.functions.cookies.get(e.properties.old.cookies.term)),t.landingpage=e.functions.old.value(e.functions.cookies.get(e.properties.old.cookies.landingpage)),t.referral=e.functions.old.value(e.functions.cookies.get(e.properties.old.cookies.referral)),t.current=e.functions.old.value(e.functions.cookies.get(e.properties.old.cookies.current)),t.session=e.functions.cookies.get(e.properties.old.cookies.session),!!t.medium&&t},session:function(){var t=e.functions.old.get();return t&&t.session?(e.functions.helpers.log({message:"Old Session is active"}),!0):(e.functions.helpers.log({message:"Old Session not active"}),!1)},upgrade:function(t,r){var i=e.functions.old.get();i?(e.functions.attribution.set(i),e.functions.helpers.log({message:"Old attribution cookies exist - updating cookies"}),e.functions.old.session()?(e.functions.helpers.log({message:"Old session is active fetching for sid"}),e.functions.session.fetch(t,i,(function(t,n){t?r(t):(e.functions.session.set(n),e.functions.attribution.set(i),e.functions.helpers.log({message:"set sid for old active session",sid:n}),r())}))):r(),e.functions.old.set()):r()}}},init:function(t,r){return e.functions.helpers.log({message:"OBAttribution init"}),e.properties.running?(e.functions.helpers.log({message:"OBAttribution init function running"}),e.functions.event.bind(window.document,e.properties.runEvent,(function(e){e.target.removeEventListener(e.type,arguments.callee),t&&window.OBAttributionCallback&&t(window.OBAttributionCallback.error,window.OBAttributionCallback.data)}))):(e.properties.running=!0,e.functions.helpers.log({message:"OBAttribution init function not running - starting to grab attribution"}),e.properties.interval&&(clearInterval(e.properties.interval),e.properties.interval=!1),e.functions.visitor.createOrExtend((function(i,n){if(i)return e.functions.helpers.log({message:"No VID was generated",error:i}),t&&t(new Error("No VID was generated")),e.properties.running=!1,window.OBAttributionCallback={error:new Error("No VID was generated")},void e.functions.event.trigger(window.document,e.properties.runEvent);e.functions.old.upgrade(n,(function(i){if(i)return e.functions.helpers.log({message:"Error upgrading cookies",error:i}),t&&t(new Error("Error upgrading cookies")),e.properties.running=!1,window.OBAttributionCallback={error:new Error("Error upgrading cookies")},void e.functions.event.trigger(window.document,e.properties.runEvent);var o=e.functions.session.get(),s=e.functions.attribution.get()||{},a=e.functions.attribution.calculate(s,o,r);e.functions.session.createOrExtend(n,a,(function(r,i,o){if(r)return e.functions.helpers.log({message:"No SID was generated",error:r}),t&&t(new Error("No SID was generated")),e.properties.running=!1,window.OBAttributionCallback={error:new Error("No SID was generated")},void e.functions.event.trigger(window.document,e.properties.runEvent);e.functions.helpers.log({message:"OBAttribution Finished",vid:n,sid:i,data:a}),e.functions.helpers.store(n,i,a),window.OBAttributionCallback={data:{vid:n,sid:i,data:a}},e.functions.event.trigger(window.document,e.properties.runEvent),e.properties.load||(e.functions.event.trigger(window.document,e.properties.initEvent,{data:{vid:n,sid:i,data:a}}),e.properties.load=!0),e.properties.interval=setInterval((function(){e.init()}),e.properties.cookie.expire.interval),o?e.functions.helpers.event((function(t,r){t?e.functions.helpers.log({message:"No EID was generated",error:t}):(e.functions.helpers.log({message:"New Session event",eid:r}),e.functions.helpers.kiss(),e.functions.helpers.event((function(t,r){t?e.functions.helpers.log({message:"No EID was generated",error:t}):e.functions.helpers.log({message:"New Pageview event",eid:r})}),{generics:{eventTypeId:43e3}}))})):e.functions.helpers.event((function(t,r){t?e.functions.helpers.log({message:"No EID was generated",error:t}):e.functions.helpers.log({message:"New Pageview event",eid:r})}),{generics:{eventTypeId:43e3}}),t&&t(null,{vid:n,sid:i,data:a}),e.properties.running=!1}))}))}))),this},push:function(){if(window.history){var t=window.history.pushState;window.history.pushState=function(e){if("function"==typeof window.history.onpushstate){var r=arguments&&arguments.length>2&&arguments[2]?arguments[2]:document.location.href;window.history.onpushstate({state:e,url:r})}return t.apply(window.history,arguments)},window.onpopstate=window.history.onpushstate=function(t){e.init(null,t&&t.url?e.functions.helpers.getAbsoluteHref(t.url):document.location.href)}}return this}},window.getAttributionData=e.init,e.functions.event.trigger(window.document,e.properties.readyEvent),e.push().init()})();