define(["jquery","version!fly/managers/debug","managers/tealium","managers/page-vars","version!fly/components/base"],function(e,t,i,a){var c=t.init("externalLink");e.widget("cnet.externalLink",e.fly.base,{options:{appendViewguid:!0,externalLinkSelector:"a[data-component=externalLink]"},viewguid:null,commerceClickPlaceholder:"___COM_CLICK_ID___",_create:function(){this._setup(),this.viewguid=a.guid,this.isCommerce=this.$element.attr("href").includes(this.commerceClickPlaceholder),this.options.appendViewguid&&this.viewguid&&this.$element.attr("href",this.$element.attr("href").replace("___VIEW_GUID___",this.viewguid)),this._setupEvents(),window.externalLink=!0},_setupEvents:function(){var t=this;this.$element.on("mousedown",function(r){if(0==r.button||1==r.button||2==r.button){c.log("External link clicked.");try{if(t._setCommerceClickId(),a.tracking.data.commerceClickId&&e(this).attr("href").includes(t.commerceClickPlaceholder)){e(this).attr("href",e(this).attr("href").replace(t.commerceClickPlaceholder,a.tracking.data.commerceClickId.replaceAll("-","")));var n=e(this).parent()[0].classList.value,l={articleId:a.tracking.data.articleId||"",commerceClickId:a.tracking.data.commerceClickId||"",dwLinkTag:"transformed-regular-link",eventTarget:(n?"."+n.replaceAll(" ",".")+" ":"")+t.options.externalLinkSelector,eventObject:r,formatType:"LINK",pageId:a.tracking.data.articleId||"",text:e(this).text()};i.trackLead(l)}else i.trackExternalLink({clickGenericText:"trackExternalLink"});setTimeout(e.proxy(function(){a.tracking.data.commerceClickId&&e(this).attr("href",e(this).attr("href").replace(a.tracking.data.commerceClickId.replaceAll("-",""),t.commerceClickPlaceholder))},this),500)}catch(e){c.log("Unable to parse tracking url",e)}}})},_setCommerceClickId:function(){var e=window.uuid();utag_data.commerceClickId=e,a.tracking.data.commerceClickId=e}})});