!function(e){var t={};function s(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=e,s.c=t,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(n,i,function(t){return e[t]}.bind(null,i));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="https://s0.bukalapak.com/marketplace/",s(s.s=528)}({528:function(e,t,s){(function(e){!function(){"use strict";const t={preproduction:{accountName:"SandboxID0084",url:"https://riskcsproxy.apac.vesta.io/DCCSProxy/Service/vdccs.js"},production:{accountName:"production",url:"https://collectorsvc.apac.vesta.io/DCCSProxy/Service/vdccs.js"}};const s=e&&e.API&&e.API.wrap||{};function n(){return e&&e.APP&&e.APP.apiURL||"https://api.bukalapak.com"}const i=`${n()}/_exclusive`;const r=s({getWebSessionId:function(){return this.get(`${i}/payments/credit-cards/fds-sessions`,"user")}},"xhrexclusiveGetWebSessionId");class o{constructor(e=[]){this.EXPIRATION_DATE_KEY="vesta_expiration_date",this.SESSION_ID_KEY="vesta_websession_id",this.ORG_ID_KEY="vesta_org_id",this.subscribers=e}getExpiryTime(){return new Date(localStorage.getItem(this.EXPIRATION_DATE_KEY))}setExpiryTime(e){localStorage.setItem(this.EXPIRATION_DATE_KEY,e.toISOString())}async getSessionId(){if(localStorage.getItem(this.SESSION_ID_KEY))return localStorage.getItem(this.SESSION_ID_KEY);return await this.getSessionInfo().session_id}setSessionId(e){localStorage.setItem(this.SESSION_ID_KEY,e)}getOrgId(){return localStorage.getItem(this.ORG_ID_KEY)}setOrgId(e){localStorage.setItem(this.ORG_ID_KEY,e)}getSubscribers(){return this.subscribers}addSubscriber(e){this.subscribers.push(e)}isExpired(){return this.getExpiryTime()-new Date<=0}async checkExpiry(){if(this.isExpired()){const e=await this.getSessionInfo();this.onSessionUpdate(e.session_id)}else this.extendsExpiryTime()}extendsExpiryTime(e=30){const t=new Date;return t.setMinutes(t.getMinutes()+e),this.setExpiryTime(t),t}async getSessionInfo(){let e,t;try{const s=await r.getWebSessionId();return e=s.data.web_session_id,t=s.data.org_id,e&&t&&(this.setSessionId(e),this.setOrgId(t),this.extendsExpiryTime()),{session_id:e,org_id:t}}catch(e){return null}}onSessionUpdate(e){this.subscribers.forEach(t=>{t.setSessionId(e)})}}class c{constructor({sessionId:e,url:t,accountName:s}){this.sessionId=e,this.url=t,this.accountName=s,this.appendNewScript()}setSessionId(e){this.sessionId=e,this.updateScriptSrc()}getSrc(){return`${this.url}?AccountName=${this.accountName}&WebSessionID=${this.sessionId}`}appendNewScript(){if(document.getElementById("vesta-web-tracker"))return;const e=document.createElement("script");e.src=this.getSrc(),e.id="vesta-web-tracker",document.getElementsByTagName("body")[0].append(e)}updateScriptSrc(){const e=document.getElementById("vesta-web-tracker");if(e){const t=this.getSrc();e.src=t}else this.appendNewScript()}}const a=`${n()}/_exclusive`;const u=s({retrieveTogglesStatus:function(e,t){const s=window.location.host.includes("m.")?"bl_mobile_web":"bl_web",n={data:{id:e,platform:t||s}};return this.post(`${a}/neo/toggles`,"user",n)},retrieveNeoConfig:function(e){return this.post("/_exclusive/neo/configs","user",{data:{id:e}})}});async function d(){if(!await async function(){try{return(await u.retrieveTogglesStatus(["payment-vesta-tracker-toggle"])).data[0].active}catch(e){return!1}}())return;const s=new o,n=await s.getSessionId(),{accountName:i,url:r}=t[e&&e.APP&&e.APP.apiURL.includes("api.bukalapak.com")?"production":"preproduction"],a=new c({sessionId:n,url:r,accountName:i});s.addSubscriber(a);const d=function(e,t){let s=0;return function(...n){const i=new Date;i-s>=t&&(e(...n),s=i)}}(()=>s.checkExpiry(),6e4);window.onload=d,window.onmousemove=d,window.ontouchstart=d,window.onclick=d,s.checkExpiry()}d()}()}).call(this,s(7))},7:function(e,t){var s;s=function(){return this}();try{s=s||new Function("return this")()}catch(e){"object"==typeof window&&(s=window)}e.exports=s}});
//# sourceMappingURL=vesta-8afd9848667def396cf0.js.map