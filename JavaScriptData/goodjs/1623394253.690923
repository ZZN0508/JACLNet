"use strict";window.wafer&&window.wafer.ready((function(){window.wafer.on("fetch:success",(function(e){var t=e.elem;if(t){if(t.classList&&(t.classList.contains("collections-view-more")&&(document.documentElement.classList.remove("Reader-closed"),document.documentElement.classList.add("Reader-open"),window.wafer.base.lock(document.getElementById("MainView")),window.scrollTo(0,0)),t.classList.contains("stream-batch-fetch"))){var i=window.rapidPageConfig&&window.rapidPageConfig.rapidConfig&&window.rapidPageConfig.rapidConfig.spaceid;i&&(window._comscore=window._comscore||[],window._comscore.push({c1:2,c2:"7241469",c5:i,c7:document.location.href,c14:window.YAHOO&&window.YAHOO.comscore&&window.YAHOO.comscore.c14||-1}),window.COMSCORE&&window.COMSCORE.purge())}var a=t.getAttribute("data-wf-url");if(a&&a.indexOf("StandAloneVideo")>-1){var r="/p.gif?info=trendingvideofetch&bucket="+(window.rapidPageConfig&&window.rapidPageConfig.rapidConfig||{}).test_id;window.wafer.utils.fireBeacon(r)}}}));var e,t,i,a,r,n,o,s,l,c,d,u=null,f=null,m=null,w=[],g=document.querySelectorAll(".stream-items"),p=document.querySelector(".stream-ad-fetch"),v=window.innerWidth||document.documentElement.clientWidth,y=window.wafer&&window.wafer.utils,L=document.querySelector(".stream-category-filter"),h=document.getElementById("Main"),A=document.getElementById("stream-filter-adpill-upsell-module"),b=!!window.localStorage.streamFilterLoginTooltipLastInteracted,E=!1,q="",S=0;if(L){var k=function(){if(!R())return!1;var e=Date.now();return void 0===window.localStorage.streamFilterLoginTooltipLastInteracted||e>=window.localStorage.streamFilterLoginTooltipLastInteracted+C},T=function(e,t,i){return function(){!e||b&&(!I||I&&S<n)||(L.offsetTop>0?(e.classList.contains("D(n)")&&N&&k()&&D(),e.style.position="fixed",e.style.top=i.classList.contains("ybar-hide-navigation")?"150px":"184px",e.style.left=t,e.classList.add("sticky-active")):(e.style.position="",e.style.bottom="",e.style.top="",e.style.left="",e.classList.remove("sticky-active")))}},N=!1,C=6048e5,I=document.getElementById("streamFilterMaxFilterClicks");I&&(n=Number(I.getAttribute("value"))),e=document.getElementById("stream-category-form"),t=document.getElementById("stream-filter-ad-pill"),"stream-category-filter-btn-",".stream-category-filter-btn-fwd",".stream-category-filter-btn-back",r=document.querySelector(".stream-filter-last-category-tooltip"),i=L.querySelector(".stream-category-filter-btn-fwd"),a=L.querySelector(".stream-category-filter-btn-back");var O=function(e){if(!E){if(e){var t=document.querySelector(".stream-filter-tooltip");t&&t.classList.add("D(n)")}else{var i=document.querySelector(".stream-filter-tooltip-close");i&&i.click()}E=!0}},R=function(){return q||(q=document.getElementById("stream-filter-login-tooltip")),q},U=function(e){if(!b){var t=R();t&&(t.classList.add("D(n)"),e&&(b=!!window.localStorage.streamFilterLoginTooltipLastInteracted))}},D=function(e){if(k()||!0===e){O(!0);var t=R();t&&t.classList.remove("D(n)")}},B=function(){document.querySelector(".stream-filter-last-category-tooltip").classList.add("D(n)"),r.classList.remove("tooltip-pointer-right")},M=function(){O(),B();var t=Math.ceil(100*e.scrollLeft/(e.scrollWidth-e.clientWidth));i.style.color=t>=100?"#ccc":"#7e1fff",0===t&&(a.style.display="none"),t>0&&(a.style.display="block",a.classList.remove("D(n)"))},P=function(){A&&(A.classList.add("D(n)"),A.classList.remove("tooltip-pointer-right"))},_=function(t,i){if(i&&h){var a=document.querySelector(t);if(a){var r="#stream-filter-adpill-upsell-module"===t?490:318,n=0,o=i.offsetLeft-e.scrollLeft-64+i.offsetWidth/2;o+r>h.offsetWidth&&(n=r-100,a.classList.add("tooltip-pointer-right")),a.style.left=o-n+"px",a.classList.remove("D(n)")}}},V=[];if((k()||I)&&(o=R(),s=document.getElementById("atomic"),l=document.querySelector(".stream-with-filters"),c=l.getClientRects(),d=Math.abs(.5*l.offsetWidth+c[0].left),"function"==typeof requestAnimationFrame?window.wafer.on("scroll",(function(){var e=d-document.documentElement.scrollLeft+"px";requestAnimationFrame(T(o,e,s))})):window.wafer.on("scroll",window.wafer.utils.throttle(T(o,d,s)),16)),L&&e&&(L.addEventListener("click",(function(i){var a=i.target;if(a&&"BUTTON"===a.tagName)a.classList.contains("stream-category-filter-btn-fwd")&&(e.scrollLeft+=500),a.classList.contains("stream-category-filter-btn-back")&&(e.scrollLeft-=500),setTimeout((function(){M()}),500),U(!0),B(),O();else if(a&&a.classList&&a.classList.contains("stream-cat-adpill-input"))A&&A.classList.contains("D(n)")?t&&_("#stream-filter-adpill-upsell-module",t.parentNode):P();else if(a&&a.classList&&a.classList.contains("stream-cat-input")){if(S++,a.parentNode.setAttribute("aria-selected",a.checked),I&&S>n){i.preventDefault(),D(!0);var r=a.getAttribute("data-display-name");return void window.rapidInstance.beaconClick("strm",r,0,{elm:"filter-prevented",itc:1})}var o=e.querySelectorAll(".stream-cat-input:checked");if(o&&o.length<=0)i.preventDefault(),setTimeout((function(){var t=e.querySelectorAll(".stream-cat-input:checked")[0],i=t&&t.getAttribute("id");i&&function(t){if(t){V.forEach((function(e){clearTimeout(e)}));var i=e&&e.querySelector("#"+t);i&&_(".stream-filter-last-category-tooltip",i.parentNode),V.push(setTimeout(B,1e4))}}(i),U(!1)}),0);else{if(a&&a.type&&"checkbox"===a.type.toLowerCase()){var s=a.getAttribute("data-display-name");window.rapidInstance.beaconClick("strm",s,0,{elm:a.checked?"filter-include":"filter-exclude",itc:1})}B()}}})),e.addEventListener("scroll",(function(e){window.requestAnimationFrame((function(){M(),P()}))})),e.addEventListener("customValidate",(function(t){var i=(e&&e.querySelectorAll(".stream-cat-input:checked").length)>0,a=new CustomEvent("customValidateStatus",{detail:{success:i}});e&&e.dispatchEvent(a)}),!1),e.addEventListener("keydown",(function(e){var t=e.target;if(e&&"Enter"===e.key&&t&&t.classList.contains("stream-filter-display-name")){var i=document.getElementById(t.getAttribute("data-cat-input-id"));i&&i.click()}})),window.wafer.on("fetch:success",(function(e){if(e.elem&&e.elem.classList.contains("stream-tab-contents")){O();var t=document.querySelector(".alternatenewsstream"),i=(t&&t.offsetTop+t.offsetParent.offsetTop+20||0)+20;t&&window.scrollY>i&&window.scrollTo(0,i-147),L.offsetTop>0&&D(),N=!0,(g=t.querySelectorAll(".stream-items"))&&g.length&&W()}})),setTimeout((function(){_(".stream-filter-tooltip",L.querySelector(".stream-filter-point-tooltip-here"))}),0)),t){var x=t.classList&&t.classList.contains("stream-cat-input")?"filter-exclude":"filter-include";window.rapidInstance&&window.rapidInstance.beaconLinkViews([{_links:[{elm:x,itc:"1",slk:"Ads"}],sec:"strm"}])}}var H={};function W(){g.forEach((function(e){if(e.addEventListener("animationend",(function(e){var t=e&&e.target;e&&t&&("hideStreamItem"===e.animationName||"fadeOutAdConfirm"===e.animationName)&&(t.classList.contains("ad-feedback-options")||(t.classList.contains("give-feedback-screen")&&(t=window.wafer.utils.findAncestor(t,"stream-item")),t.parentNode&&(window.wafer.base.destroy(t),t.parentNode.removeChild(t))))})),e.addEventListener("click",(function(t){var i=t.target;if(i.classList.contains("userintent-undo")){var a=i.getAttribute("data-wf-toggle-target"),r=e.querySelector(a);if(r){var n=r.getAttribute("data-uuid");n&&H[n]&&clearTimeout(H[n])}}!function(e){window.location.href.indexOf("functest=1")>-1&&e.preventDefault();var t=e.target;if(!y||!t)return;var i=y.findAncestor(t,"js-content-viewer");if(!i)return;var a=y.findAncestor(i,"stream-cluster-item")||y.findAncestor(i,"js-stream-content");if(!a)return;var r=a.getAttribute("data-uuid");if(r){var n=a&&a.getAttribute("data-parent-uuid");if(u=n&&document.querySelector('li[data-uuid="'+n+'"]')||a,m=u&&u.getElementsByClassName("stream-related-drawer")[0]){if(u.classList.contains("show-drawer"))return;var o=function(){for(var e=Array.prototype.slice.call(document.getElementsByClassName("stream-uuid-list")),t=0;t<e.length;t++){var i=e[t],a=i.text;i.classList.remove("stream-uuid-list");try{var r=JSON.parse(a);r&&Array.isArray(r.uuidList)&&w.length+r.uuidList.length<=250&&(w=w.concat(r.uuidList))}catch(e){}}return{dedupUuids:w}}(),s={config:{leadItemUuid:n||r},ctrl:"StreamRelated",m_id:"tdv2-wafer-stream",m_mode:"json"},l={dedupUuids:o.dedupUuids.join(","),uuid:r},c=m.getAttribute("data-cfg");if(c){var d=a.getAttribute("data-cposy");d=isNaN(d)?null:parseInt(d,10);try{var g=JSON.parse(c);g&&g.i13n&&(f=g.i13n),null!==d&&(g.i13n.cposy=d),s.config=Object.assign(s.config,g)}catch(e){}}var p=m.getAttribute("data-bucket");p&&(s.bucket=p),s.config.ncpParams=s.config.ncpParams||{},s.config.ncpParams.query=s.config.ncpParams.query||{},s.config.ncpParams.query=Object.assign(l,s.config.ncpParams.query);var v=window.wafer.base.state.drawer,L=v&&v.adsToken;L&&(s.config.ncpParams.query.geminiDedupeToken=L),m.setAttribute("data-wf-body",JSON.stringify(s)),m.classList.remove("wafer-fetch-error","wafer-fetch-complete"),m.classList.add("wafer-fetch"),window.wafer.base.sync(m.parentNode)}}}(t)})),p&&window.wafer.base&&window.wafer.utils){var t=p.getAttribute("data-wf-url"),i=p.getAttribute("data-wf-state-body");window.wafer.utils.fetchWithCache(t,{body:i,cache:0}).then((function(t){if(t&&t.html){p.innerHTML=t.html;var i=p.querySelectorAll(".stream-ad"),a=p.getElementsByClassName("wafer-state")[0],r=e.querySelectorAll(".stream-ad-placeholder");if(i&&r)for(var n=i.length,o=r.length,s=0;s<o&&s<n;s++)r[s].replaceWith(i[s]);p.innerHTML="",a&&p.appendChild(a),window.wafer.base.sync(e)}}))}var a=e.querySelectorAll(".js-sponsored-moments-dwell-time, .js-sponsored-moments-dwell-time-mon");if(a.length){a.forEach((function(e){e.classList&&e.classList.contains("js-reserve-moments")&&(window.DARLA?function e(t){var i=Math.floor(16*v/9),a=t.querySelector("#defaultRESERVEMOMENTS"),r=a&&a.getAttribute("data-html");if(r){var n=window.DARLA.prefetched();if(window.DARLA.inProgress()||n&&0!==n.length)setTimeout((function(){e(t)}),500);else{var o={dest:"defaultRESERVEMOMENTS",flex:{h:{min:i},w:{min:v}},h:i,id:"RESERVEMOMENTS",supports:{"exp-ovr":1,"exp-push":1,"resize-to":1},w:v};window.DARLA.addPos(o);var s=new window.DARLA.Response("RESERVEMOMENTS",{});r=unescape(r),s.add("RESERVEMOMENTS",r),window.DARLA.render(s)}}}(e):e.style.display="none")}));var r=a[0].querySelector(".js-panorama-scroll-view");r&&0===r.scrollLeft&&(r.scrollLeft=(r.scrollWidth-v)/2)}}))}if(g&&g.length){W();var j,F,Y=document.getElementById("scrollable-smad"),$=document.getElementById("scrollable-video"),J=window.innerHeight||document.documentElement.clientHeight,z={},G=function(e){return e&&(e=(e=(e=(e=(e=(e=e.replace(/\$\(V_AUTOPLAYED\)/,!1)).replace(/\$\(V_PLAYER_WIDTH\)/,Y.clientHeight)).replace(/\$\(V_PLAYER_HEIGHT\)/,Y.clientWidth)).replace(/\$\(V_SKIP_AVAIL\)/,!1)).replace(/\$\(V_EXPANDED\)/,!1)).replace(/\$\(V_AUD_INFO\)/,2)),e};if(Y){var K=Y.getBoundingClientRect();j=K.top-J,F=K.bottom-j,z.startActionUrl=Y.getAttribute("data-video-quartile-start"),z.quartileActionUrl25=Y.getAttribute("data-video-quartile-25"),z.quartileActionUrl50=Y.getAttribute("data-video-quartile-50"),z.quartileActionUrl75=Y.getAttribute("data-video-quartile-75"),z.quartileActionUrl100=Y.getAttribute("data-video-quartile-100")}Y&&$&&window.addEventListener("scroll",window.wafer.utils.throttle((function(){var e=$&&$.duration,t=Y.getBoundingClientRect();if(t.top<J&&t.bottom>0){$.currentTime=(window.pageYOffset-j)*e/F;var i=(J-t.top)/J*100;(i=5*Math.ceil(i/5))>=100&&z.quartileActionUrl100?(window.wafer.utils.fireBeacon(G(z.quartileActionUrl100),{useNavigator:!1}),z.quartileActionUrl100=null):i>=75&&z.quartileActionUrl75?(window.wafer.utils.fireBeacon(G(z.quartileActionUrl75),{useNavigator:!1}),z.quartileActionUrl75=null):i>=50&&z.quartileActionUrl50?(window.wafer.utils.fireBeacon(G(z.quartileActionUrl50),{useNavigator:!1}),z.quartileActionUrl50=null):i>=25&&z.quartileActionUrl25?(window.wafer.utils.fireBeacon(G(z.quartileActionUrl25),{useNavigator:!1}),z.quartileActionUrl25=null):i>=5&&z.startActionUrl&&(window.wafer.utils.fireBeacon(G(z.startActionUrl),{useNavigator:!1}),z.startActionUrl=null)}}),16))}window.addEventListener("viewerClosed",(function(){if(u&&!u.classList.contains("show-drawer")){var e=m&&!!m.getElementsByClassName("stream-realted-list")[0];if(e){u.classList.add("drawer-beacon");var t=u;setTimeout((function(){t.classList.add("show-drawer")}),10)}e&&f&&window.rapidInstance&&window.rapidInstance.beaconClick("strm","youmaylike",0,Object.assign(f,{_p:0,cnt_tpc:f.categoryLabel,g:u.getAttribute("data-uuid"),grpt:"storyCluster",itc:1,pkgt:"youmaylike"})),f="",m=null,u=null}}));window.wafer.on("toggle:change",(function(e){if(e&&e.meta&&e.elem){var t=e.elem,i=t.getAttribute("data-wf-toggle-target");if("userintent-hidestrmitem"===e.meta.className&&"add"===e.meta.action&&g&&g.length)g.forEach((function(e){if(i&&e){var t=e.querySelector(i),a=t&&t.getAttribute("data-uuid");a&&(H[a]=setTimeout((r=t,function(){r.classList.contains("userintent-disliked-anim")||r.classList.add("userintent-disliked-anim")}),8e3))}var r}));else if("show-drawer"===e.meta.className)g&&g.length&&g.forEach((function(e){var t=e.querySelector(i),a=t&&t.getElementsByClassName("drawer-fetch-target")[0];setTimeout((function(){a&&(a.innerHTML="")}),300)}));else if("userintent-show"===e.meta.className&&t){var a=window.wafer.utils.findAncestor(t,"stream-item");if(!a)return;"add"===e.meta.action?(a.classList.add("userintent-show-reason"),window.rapidInstance&&window.rapidInstance.reevaluateModulesViewability(a)):"remove"===e.meta.action&&a.classList.remove("userintent-show-reason")}else e.elem&&e.elem.classList.contains("stream-filter-login-tooltip-close")&&(window.localStorage.streamFilterLoginTooltipLastInteracted=Date.now())}}))}));