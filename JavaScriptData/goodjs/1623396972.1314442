(window.monolithJsonpFunction=window.monolithJsonpFunction||[]).push([["54e35a8e"],{10955:function(e,n,t){"use strict";var r={};t.r(r),t.d(r,"PHONE_CONFIRM_CODE",(function(){return l})),t.d(r,"openChatByChannelId",(function(){return f})),t.d(r,"openChat",(function(){return v})),t.d(r,"sendTextMessage",(function(){return h}));var o=t(3956),i=t.n(o),a=t(4326),c=t(6561),s=t(5923),u=t(4206),l=-32060;function d(e,n){n?n.push(e):window.location.href=e}function f(e){var n,t,r=e.channelId,o=e.draftText,i=e.interlocutorId,s=e.isMiniMessenger,u=e.browserHistory;o&&void 0!==i&&(s||Boolean(null===(n=window.avito)||void 0===n||null===(t=n.messenger)||void 0===t?void 0:t.helpers)?a.c({channelId:r,interlocutorId:i,text:o}):c.e({channelId:r,interlocutorId:i,text:o})),s?a.b(r):d("/profile/messenger/channel/".concat(r),u)}function v(e){return p.apply(this,arguments)}function p(){return(p=babelHelpers.asyncToGenerator(regeneratorRuntime.mark((function e(n){var t,r,o,v,p,h,b,g,w,m,y,I,_,S,k,x;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.itemId,r=n.interlocutorId,o=n.draftText,v=n.isMiniMessenger,p=n.isMobile,h=n.browserHistory,b=n.requestApi,g=void 0===b?i.a.get("httpFallback"):b,w=n.onAuthError,!t||!r){e.next=3;break}throw Error("invalid params, use only one of itemId or interlocutorId");case 3:if(t||r){e.next=5;break}throw Error("itemId or interlocutorId is required");case 5:if(m=v?u.a.MINI:u.a.DESKTOP,p&&(m=u.a.MOBILE),y="app_name=".concat(m),I=-1!==g.indexOf("?")?"".concat(g,"&").concat(y):"".concat(g,"?").concat(y),e.prev=9,_=null,!t){e.next=17;break}return e.next=14,s.a(I,t);case 14:_=e.sent,e.next=21;break;case 17:if(!r){e.next=21;break}return e.next=20,s.b(I,r);case 20:_=e.sent;case 21:_&&(k=null===(S=_.info)||void 0===S?void 0:S.userId,f({channelId:_.channelId,interlocutorId:k,draftText:o,isMiniMessenger:v,browserHistory:h})),e.next=28;break;case 24:throw e.prev=24,e.t0=e.catch(9),e.t0.code===l?(o&&c.d({itemId:t||void 0,userId:r||void 0,text:o}),v?a.d(t,r):(x=t?"create_chat=".concat(t):"create_user_chat=".concat(r),d("/profile/messenger?".concat(x),h))):401===e.t0.status&&w&&w(),e.t0;case 28:case"end":return e.stop()}}),e,null,[[9,24]])})))).apply(this,arguments)}var h=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.a.get("httpFallback");return s.c(t,e,n)};t.d(n,"b",(function(){return b})),t.d(n,"a",(function(){return r}));var b=v},3956:function(e,n,t){"use strict";var r={};e.exports={init:function(e){r=Object.assign(r,e)},get:function(e){if(!Object.keys(r).length)throw new Error("Please init SiteIntegration before use messenger");return r[e]},set:function(e,n){r[e]=n}}},4038:function(e,n,t){var r=t(4039),o=t(4040),i=Object.prototype.hasOwnProperty;e.exports=function(e,n,t){var a=e[n];i.call(e,n)&&o(a,t)&&(void 0!==t||n in e)||r(e,n,t)}},4039:function(e,n,t){var r=t(4016);e.exports=function(e,n,t){"__proto__"==n&&r?r(e,n,{configurable:!0,enumerable:!0,value:t,writable:!0}):e[n]=t}},4189:function(e,n,t){var r=t(4190);e.exports=function(e,n,t){return null==e?e:r(e,n,t)}},4190:function(e,n,t){var r=t(4038),o=t(4149),i=t(4026),a=t(3980),c=t(4157);e.exports=function(e,n,t,s){if(!a(e))return e;for(var u=-1,l=(n=o(n,e)).length,d=l-1,f=e;null!=f&&++u<l;){var v=c(n[u]),p=t;if("__proto__"===v||"constructor"===v||"prototype"===v)return e;if(u!=d){var h=f[v];void 0===(p=s?s(h,v,f):void 0)&&(p=a(h)?h:i(n[u+1])?[]:{})}r(f,v,p),f=f[v]}return e}},4191:function(e,n,t){"use strict";t.d(n,"b",(function(){return u})),t.d(n,"a",(function(){return l})),t.d(n,"d",(function(){return d})),t.d(n,"f",(function(){return f})),t.d(n,"c",(function(){return v})),t.d(n,"e",(function(){return p}));var r=t(4192),o=t(3956),i=t.n(o),a=Object(r.a)()||{os:"unknown",name:"unknown",version:"unknown"};function c(e){return e.replace(/[.\s]/g,"_")}function s(e){return"".concat(e).concat("")}function u(){var e=window.navigator,n=e.connection||e.mozConnection||e.webkitConnection||e.msConnection||{type:"unknown",effectiveType:"unknown"};return c(n.type||n.effectiveType||"unknown")}function l(e){return{appName:s(e),browserName:c(a.name),networkType:u(),os:"_",browserVersion:"_"}}function d(){return navigator&&navigator.onLine}function f(){var e=i.a.get("chatsScrollNodeSelector"),n=e&&document.querySelector(e)||window;n.scrollTo.apply(n,arguments)}var v="undefined"!=typeof window,p=function(e){return window.location.href=e}},4192:function(e,n,t){"use strict";(function(e){t.d(n,"a",(function(){return f}));var r=function(){for(var e=0,n=0,t=arguments.length;n<t;n++)e+=arguments[n].length;var r=Array(e),o=0;for(n=0;n<t;n++)for(var i=arguments[n],a=0,c=i.length;a<c;a++,o++)r[o]=i[a];return r},o=function(e,n,t){this.name=e,this.version=n,this.os=t,this.type="browser"},i=function(n){this.version=n,this.type="node",this.name="node",this.os=e.platform},a=function(e,n,t,r){this.name=e,this.version=n,this.os=t,this.bot=r,this.type="bot-device"},c=function(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null},s=function(){this.type="react-native",this.name="react-native",this.version=null,this.os=null},u=/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,l=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FBAV\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],d=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function f(n){return n?p(n):"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product?new s:"undefined"!=typeof navigator?p(navigator.userAgent):void 0!==e&&e.version?new i(e.version.slice(1)):null}function v(e){return""!==e&&l.reduce((function(n,t){var r=t[0],o=t[1];if(n)return n;var i=o.exec(e);return!!i&&[r,i]}),!1)}function p(e){var n=v(e);if(!n)return null;var t=n[0],i=n[1];if("searchbot"===t)return new c;var s=i[1]&&i[1].split(/[._]/).slice(0,3);s?s.length<3&&(s=r(s,function(e){for(var n=[],t=0;t<e;t++)n.push("0");return n}(3-s.length))):s=[];var l=s.join("."),f=function(e){for(var n=0,t=d.length;n<t;n++){var r=d[n],o=r[0];if(r[1].exec(e))return o}return null}(e),p=u.exec(e);return p&&p[1]?new a(t,l,f,p[1]):new o(t,l,f)}}).call(this,t(4193))},4196:function(e,n,t){"use strict";var r,o=t(4147),i=t.n(o),a=t(4189),c=t.n(a),s=t(4197),u=t.n(s),l=t(4191),d=["isApiFetchEvent"],f="bundle_loading_start",v="bundle_loading_end",p="transport_connect_start",h="session",b="api_fetch_start",g="api_fetch_end",w="result_render",m="navigation_start",y=(r={},babelHelpers.defineProperty(r,"".concat(m,".").concat(f),"РњРµСЃСЃРµРЅРґР¶РµСЂ(РћР¶РёРґР°РЅРёРµ РґСЂСѓРіРёС… СЃРєСЂРёРїС‚РѕРІ)"),babelHelpers.defineProperty(r,"".concat(f,".").concat(v),"РњРµСЃСЃРµРЅРґР¶РµСЂ(РЎРµС‚СЊ: РћР¶РёРґР°РЅРёРµ РіРѕС‚РѕРІРЅРѕСЃС‚Рё Р±Р°РЅРґР»Р°)"),babelHelpers.defineProperty(r,"".concat(v,".").concat(p),"РњРµСЃСЃРµРЅРґР¶РµСЂ(РРЅРёС†РёР°Р»РёР·Р°С†РёСЏ)"),babelHelpers.defineProperty(r,"".concat(p,".").concat(h),"РњРµСЃСЃРµРЅРґР¶РµСЂ(РђРїРё: РћР¶РёРґР°РЅРёРµ СЃРµСЃСЃРёРё)"),babelHelpers.defineProperty(r,"".concat(h,".").concat(b),"РњРµСЃСЃРµРЅРґР¶РµСЂ(РћР±СЂР°Р±РѕС‚РєР° СЃРµСЃСЃРёРё)"),babelHelpers.defineProperty(r,"".concat(b,".").concat(g),"РњРµСЃСЃРµРЅРґР¶РµСЂ(РђРїРё: РћР¶РёРґР°РЅРёРµ РґР°РЅРЅС‹С…)"),babelHelpers.defineProperty(r,"".concat(g,".").concat(w),"РњРµСЃСЃРµРЅРґР¶РµСЂ(РћС‚СЂРёСЃРѕРІРєР° СЌРєСЂР°РЅР°)"),babelHelpers.defineProperty(r,"".concat(h,".").concat(w),"РњРµСЃСЃРµРЅРґР¶РµСЂ(РћС‚СЂРёСЃРѕРІРєР° СЌРєСЂР°РЅР°)"),r),I=l.c?window.performance:null;var _=function(){function e(){babelHelpers.classCallCheck(this,e),this.eventsLog={},this.isPageLoaded=!0}return babelHelpers.createClass(e,[{key:"logBundleLoadingStart",value:function(){this.logEvent(f),c()(window,["avito.messenger.perfEventsLog",f],this.eventsLog.bundle_loading_start)}},{key:"logBundleLoadingEnd",value:function(){this.logEvent(v)}},{key:"logTransportConnect",value:function(){this.logEvent(p)}},{key:"logSession",value:function(){this.logEvent(h)}},{key:"logResultRender",value:function(){this.logEvent(w)}},{key:"logApiFetch",value:function(e){var n=this,t=e.isApiFetchEvent,r=babelHelpers.objectWithoutProperties(e,d);return t&&r.fetching&&(this.logEvent(b),r.fetching=r.fetching.then((function(e){return n.logEvent(g),e}),(function(e){throw n.logEvent(g),e}))),r}},{key:"logEvent",value:function(e){this.eventsLog[e]=I&&I.now?I.now():Date.now(),I&&I.mark&&I.mark(e)}},{key:"buildInterval",value:function(e,n,t,r){var o="".concat(e,".").concat(t);if(I&&I.measure){var i=y[o];if(i)try{I.measure(i,e,t)}catch(e){}}return[o,Math.round(r-n)]}},{key:"buildPayload",value:function(e){var n=e.appName,t=e.screenName,r=e.transport,o={},i=Object(l.a)(n),a=i.appName,c=i.os,s=i.browserName,u=i.browserVersion,d=i.networkType,f="tm.ui_perf_m.".concat(a,".").concat(c,".").concat(s,".").concat(u,".")+"".concat(d,".").concat(r,".").concat(t),v=Object.entries(this.eventsLog);v.sort((function(e,n){var t=babelHelpers.slicedToArray(e,2),r=(t[0],t[1]),o=babelHelpers.slicedToArray(n,2);o[0];return r-o[1]}));for(var p=1;p<v.length;p++){var h=this.buildInterval.apply(this,babelHelpers.toConsumableArray(v[p-1]).concat(babelHelpers.toConsumableArray(v[p]))),b=babelHelpers.slicedToArray(h,2),g=b[0],w=b[1];o["".concat(f,".").concat(g)]=w}return o}},{key:"sendMetrics",value:function(e){var n=e.appName,t=e.screenName,r=e.transport,o=e.metricsUrl;this.isPageLoaded&&I&&I.now&&(this.eventsLog.navigation_start=0);var a=i()(window,["avito.messenger.perfEventsLog",f]);a&&(this.eventsLog.bundle_loading_start=a),function(e,n){fetch(n,{method:"post",credentials:"include",body:JSON.stringify(e)})}(this.buildPayload({appName:n,screenName:t,transport:r}),o),this.isPageLoaded=!1,this.eventsLog={},u()(window,["avito.messenger.perfEventsLog",f])}}]),e}();n.a=new _},4197:function(e,n,t){var r=t(4198);e.exports=function(e,n){return null==e||r(e,n)}},4198:function(e,n,t){var r=t(4149),o=t(4199),i=t(4200),a=t(4157);e.exports=function(e,n){return n=r(n,e),null==(e=i(e,n))||delete e[a(o(n))]}},4199:function(e,n){e.exports=function(e){var n=null==e?0:e.length;return n?e[n-1]:void 0}},4200:function(e,n,t){var r=t(4148),o=t(4201);e.exports=function(e,n){return n.length<2?e:r(e,o(n,0,-1))}},4201:function(e,n){e.exports=function(e,n,t){var r=-1,o=e.length;n<0&&(n=-n>o?0:o+n),(t=t>o?o:t)<0&&(t+=o),o=n>t?0:t-n>>>0,n>>>=0;for(var i=Array(o);++r<o;)i[r]=e[r+n];return i}},5923:function(e,n,t){"use strict";function r(e,n,t){return o.apply(this,arguments)}function o(){return(o=babelHelpers.asyncToGenerator(regeneratorRuntime.mark((function e(n,t,r){var o,i,a,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(n,{method:"post",credentials:"include",body:JSON.stringify({jsonrpc:"2.0",id:Date.now(),method:t,params:r})});case 2:if(200===(o=e.sent).status){e.next=5;break}throw o;case 5:return e.next=7,o.json();case 7:if(i=e.sent,a=i.result,!(c=i.error)){e.next=12;break}throw c;case 12:return e.abrupt("return",a);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function i(e,n,t){return r(e,"avito.chatCreateByItemId.v1",{itemId:n,source:t})}function a(e,n){return r(e,"messenger.chatCreateByUserId.v1",{opponentId:n})}function c(e,n,t){return r(e,"avito.sendTextMessage",{channelId:n,text:t,randomId:Date.now()})}t.d(n,"a",(function(){return i})),t.d(n,"b",(function(){return a})),t.d(n,"c",(function(){return c}))},6561:function(e,n,t){"use strict";t.d(n,"c",(function(){return s})),t.d(n,"f",(function(){return u})),t.d(n,"e",(function(){return l})),t.d(n,"a",(function(){return d})),t.d(n,"d",(function(){return f})),t.d(n,"b",(function(){return v}));var r=t(6562),o=t(4357),i=t(10963),a="__msgr_deferred_draft",c=function(e){var n=e.itemId,t=e.userId;return void 0!==n?"".concat(a,"_item_").concat(n):"".concat(a,"_user_").concat(t)},s=function(e){var n=r.b.getItem(r.a.DRAFT_MESSAGES,null==e?void 0:e.toString());return n?JSON.parse(n):n},u=function(e,n){return r.b.setItem(r.a.DRAFT_MESSAGES,JSON.stringify(e),null==n?void 0:n.toString())},l=function(e){var n=e.channelId,t=e.text,r=e.interlocutorId,a=e.userId,c=s(a)||void 0,l=Object(i.setDraftMessage)({channelId:n,text:t,interlocutorId:r}),d=Object(o.a)(c,l);u(d,a)},d=function(e){return r.b.removeItem(r.a.DRAFT_MESSAGES,null==e?void 0:e.toString())},f=function(e){var n=e.itemId,t=e.userId,o=e.text;return r.b.setItem(c({itemId:n,userId:t}),o)},v=function(e){var n=e.itemId,t=e.userId;return r.b.getItem(c({itemId:n,userId:t}))}},6562:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var r=t(4188),o=t(4191).c?window.localStorage:void 0;function i(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return"".concat(e,"_").concat(n,"_").concat(t)}n.b={getItem:function(e,n,t){return o?o.getItem(i(e,n,t)):null},setItem:function(e,n,t,r){if(o)try{o.setItem(i(e,t,r),n)}catch(e){}},removeItem:function(e,n,t){o&&o.removeItem(i(e,n,t))}};var a=Object(r.a)({DRAFT_MESSAGES:null})}}]);