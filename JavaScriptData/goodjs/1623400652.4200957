(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([[605],{1115:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return["email","phone","facebook","google","yolo"].includes(e)}},1117:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return!("string"!=typeof e||!e)&&/^[a-zA-Z0-9-_=+.]+(( nill | )[a-zA-Z0-9-_=+.]+( [a-zA-Z0-9-_=+.]+)?)?$/.test(e)}},3452:function(e,t){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"LoginMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"TokenRequest"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"login_token"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"access_token"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"sid"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"acc_sid"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"errors"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"message"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"sq_check"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"cotp_url"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"uid"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:134}};n.loc.source={body:"mutation LoginMutation($input:TokenRequest!){login_token(input:$input){access_token sid acc_sid errors{message}sq_check cotp_url uid}}",name:"GraphQL request",locationOffset:{line:1,column:1}};function i(e,t){if("FragmentSpread"===e.kind)t.add(e.name.value);else if("VariableDefinition"===e.kind){var n=e.type;"NamedType"===n.kind&&t.add(n.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){i(e,t)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){i(e,t)})),e.definitions&&e.definitions.forEach((function(e){i(e,t)}))}var o={};function a(e,t){for(var n=0;n<e.definitions.length;n++){var i=e.definitions[n];if(i.name&&i.name.value==t)return i}}n.definitions.forEach((function(e){if(e.name){var t=new Set;i(e,t),o[e.name.value]=t}})),e.exports=n,e.exports.LoginMutation=function(e,t){var n={kind:e.kind,definitions:[a(e,t)]};e.hasOwnProperty("loc")&&(n.loc=e.loc);var i=o[t]||new Set,c=new Set,r=new Set;for(i.forEach((function(e){r.add(e)}));r.size>0;){var s=r;r=new Set,s.forEach((function(e){c.has(e)||(c.add(e),(o[e]||new Set).forEach((function(e){r.add(e)})))}))}return c.forEach((function(t){var i=a(e,t);i&&n.definitions.push(i)})),n}(n,"LoginMutation")},3453:function(e,t,n){"use strict";var i=n(13);Object.defineProperty(t,"__esModule",{value:!0}),t.trackLogin=function(e){var t=e.provider,n=e.status,i=e.description,a=e.descriptionCode;switch(t){case"email":!function(e){var t=e.status,n=e.description;switch(t){case"click":(0,o.default)({event:"eventClickLogin",eventCategory:"pop up login page",eventAction:"click on masuk ke tokopedia",eventLabel:"click"});break;case"success":(0,o.default)({event:"eventClickLogin",eventCategory:"pop up login page",eventAction:"click on masuk ke tokopedia",eventLabel:"success"});break;case"failed":!function(e){var t=e.description;(0,o.default)({event:"eventClickLogin",eventCategory:"pop up login page",eventAction:"click on masuk ke tokopedia",eventLabel:"failed - ".concat(t)})}({description:n})}}({status:n,description:i});break;case"facebook":case"google":!function(e){var t=e.provider,n=e.status,i=e.description;switch(n){case"click":!function(e){var t=e.provider;(0,o.default)({event:"eventClickLogin",eventCategory:"pop up login page",eventAction:"click on masuk dengan ".concat(t),eventLabel:"click"})}({provider:t});break;case"success":!function(e){var t=e.provider;(0,o.default)({event:"eventClickLogin",eventCategory:"pop up login page",eventAction:"click on masuk dengan ".concat(t),eventLabel:"success"})}({provider:t});break;case"failed":!function(e){var t=e.provider,n=e.description;(0,o.default)({event:"eventClickLogin",eventCategory:"pop up login page",eventAction:"click on masuk dengan ".concat(t),eventLabel:"failed - ".concat(n)})}({provider:t,description:i})}}({provider:t,status:n,description:i});break;case"yolo":!function(e){var t=e.status,n=e.description,i=e.descriptionCode;switch(t){case"click":(0,o.default)({event:"clickLogin",eventCategory:"login page",eventAction:"click on google YOLO",eventLabel:"click"});break;case"close":(0,o.default)({event:"clickLogin",eventCategory:"login page",eventAction:"click on close google YOLO",eventLabel:""});break;case"success":(0,o.default)({event:"clickLogin",eventCategory:"login page",eventAction:"click on google YOLO",eventLabel:"success"});break;case"failed":"TIMEOUT"===i?(0,o.default)({event:"clickLogin",eventCategory:"login page",eventAction:"click on YOLO timeout",eventLabel:"failed yolo timeout"}):function(e){var t=e.description,n="failed - ".concat(t);(0,o.default)({event:"clickLogin",eventCategory:"login page",eventAction:"click on google YOLO",eventLabel:n})}({description:n})}}({status:n,description:i,descriptionCode:a})}};var o=i(n(3454))},3454:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.event,n=void 0===t?"":t,i=e.eventCategory,o=void 0===i?"":i,a=e.eventAction,c=void 0===a?"":a,r=e.eventLabel,s=void 0===r?"":r;window.dataLayer&&window.dataLayer.push({event:n,eventCategory:o,eventAction:c,eventLabel:s})}},4650:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return P}));var i=n(21),o=n(53),a=n(10),c=n.n(a),r=n(591),s=n.n(r),d=n(738),u=n.n(d),l=n(905),v=n.n(l),p=n(994),f=n.n(p),g=n(885),k=n.n(g),m=n(906),b=n.n(m),h=n(3453),y=n(56),L=n.n(y),O=n(211);var _=n(3452),w=n.n(_),S=n(200),C=n.n(S),A=n(90),D=n.n(A);function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){Object(i.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function P(e){var t,n,i=e.apolloClient,a=e.setIsLoading,r=e.tokopediaClientId,d=e.VISITED,l=e.PROVIDER,p=e.FROM_WIDGET,g=e.xdevice,m=e.pathname,y=e.search,_=e.hash,S=e.swExclude,A=e.googleId,j=function(){var e=Object(o.a)(c.a.mark((function e(t){var n,o,L,C,A,D,j,P,N,M,T,x,I,F,R,U,q,W;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return N=u()(4),M={currentUrl:window.location.href,visited:d,provider:l,fromWidget:p},a(!0),e.prev=3,e.next=6,i.mutate({mutation:w.a,variables:{input:{grant_type:"".concat(btoa("extension")).concat(N),social_type:O.a,access_token:t,supported:"true",cotp_ld:f()(M)}},context:{headers:E(E({},s()("login")),{},{server:"go","Accounts-Authorization":"".concat(btoa(r)).concat(N),"X-Device":g})}});case 6:P=e.sent,e.next=14;break;case 9:return e.prev=9,e.t0=e.catch(3),a(!1),Object(h.trackLogin)({provider:l,status:"failed",description:e.t0.message,descriptionCode:""}),e.abrupt("return");case 14:if(T=null===(n=P)||void 0===n||null===(o=n.data)||void 0===o?void 0:o.login_token,!(x=null!==(L=null==T||null===(C=T.errors)||void 0===C||null===(A=C[0])||void 0===A?void 0:A.message)&&void 0!==L?L:"")){e.next=20;break}return a(!1),Object(h.trackLogin)({provider:l,status:"failed",description:x,descriptionCode:""}),e.abrupt("return");case 20:if(I=null!==(D=null==T?void 0:T.sid)&&void 0!==D?D:""){e.next=25;break}return a(!1),Object(h.trackLogin)({provider:l,status:"failed",description:"sid empty",descriptionCode:""}),e.abrupt("return");case 25:if(F=null==T?void 0:T.sq_check,R=null==T?void 0:T.cotp_url,U=null!==(j=null==T?void 0:T.acc_sid)&&void 0!==j?j:"",q=v()(l,{sid:I,sidAccount:U}),!F){e.next=37;break}if(R){e.next=34;break}return a(!1),Object(h.trackLogin)({provider:l,status:"failed",description:"sq invalid",descriptionCode:""}),e.abrupt("return");case 34:return b()(q),window.location.assign(R),e.abrupt("return");case 37:return W={apolloClient:i,fromWidget:p,provider:l,pathname:m,search:y,hash:_,visited:d,outsides:S,onGetUserError:function(e){var t,n=e.error;a(!1),t=n?(null==n?void 0:n.message)||String(n):"Error getting user data",Object(h.trackLogin)({provider:l,status:"failed",description:t,descriptionCode:""})},onSuccess:function(){a(!1),Object(h.trackLogin)({provider:l,status:"success",description:"",descriptionCode:""}),window.location.reload()}},e.next=40,k()(W);case 40:case"end":return e.stop()}}),e,null,[[3,9]])})));return function(t){return e.apply(this,arguments)}}(),P=function(){var e=Object(o.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(h.trackLogin)({provider:l,status:"click",description:"",descriptionCode:""}),j(t.credential);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();t=!0,(n=new Date).setMinutes(n.getMinutes()+5),D()(O.c,t,n),C()({src:"https://accounts.google.com/gsi/client",async:!0,defer:!0,callback:function(){google.accounts&&(google.accounts.id.initialize({client_id:A,callback:P,auto_select:!Boolean(L()(O.b))}),google.accounts.id.prompt((function(e){e.isSkippedMoment()&&Object(h.trackLogin)({provider:l,status:"close",description:"",descriptionCode:""})})))}})}},905:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){switch(e){case"email":return i("email",t);case"phone":return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.sid,n=e.keyAccess,i=e.sidAccount;if(!t||!n)throw new TypeError("To get full SID of login by phone, you must pass SID and access key. Passed SID: ".concat(t,". Passed access key: ").concat(n,"."));return i?"".concat(t," ").concat(n," ").concat(i):"".concat(t," ").concat(n)}(t);case"facebook":return i("facebook",t);case"google":return i("google",t);case"yolo":return i("yolo",t);default:throw new TypeError("".concat(e," is not valid provider name."))}};var i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.sid,i=t.sidAccount;if(!n)throw new TypeError("To get full SID of login by ".concat(e,", you must pass SID. Passed SID: ").concat(n,"."));return i?"".concat(n," nill ").concat(i):n}},906:function(e,t,n){"use strict";var i=n(13);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if((0,a.default)(e)){var t=new Date;t.setMinutes(t.getMinutes()+5),(0,o.default)(c.AFTER_SQ_FULL_SID_STORAGE_KEY,e,t)}};var o=i(n(90)),a=i(n(1117)),c=n(149)},994:function(e,t,n){"use strict";var i=n(13);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.currentUrl,n=e.visited,i=e.provider,c=e.fromWidget,r=void 0!==c&&c,s=new URL(t),d=s.pathname,u=s.search,l=s.hash,v=new URL("/after_sq",t),p=(0,a.default)({pathname:d,search:u,hash:l,visited:n,provider:i,fromWidget:r});v.searchParams.set("ld",p);var f=s.searchParams.get("fromWidget");(r||f)&&v.searchParams.set("fromWidget",1);(0,o.default)(i)&&v.searchParams.set("via",i);return v.toString()};var o=i(n(1115)),a=i(n(1116))}}]);