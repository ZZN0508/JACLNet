(self.webpackChunkO11yRUM=self.webpackChunkO11yRUM||[]).push([[361],{917:function(e,t,r){var n,o,a;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,o=[t,r(591),r(862)],void 0===(a="function"==typeof(n=function(r,n,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,n=a(n),o=a(o);var u={"Content-Type":"application/json","Content-Encoding":"gzip"},f=function(e){var t={};return e?(Object.keys(e).forEach((function(r){e[r]&&"string"==typeof e[r]?t[r]=e[r]:e[r]&&"function"==typeof e[r].toString&&(t[r]=e[r].toString())})),t):t},l=function(e){switch(e.metricName){case"FCP":return 2;case"LCP":return 3;case"CLS":return 1;case"FID":return 5;default:return 0}},m=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!t)throw new Error("O11y RUM: RumGZIPTransformer config is not defined.");if(!t.startTime)throw new Error("O11y RUM: RumGZIPTransformer config.startTime is not defined.");if(!t.cacheTime)throw new Error("O11y RUM: RumGZIPTransformer config.cacheTime is not defined.");if(!t.initialCacheTime)throw new Error("O11y RUM: RumGZIPTransformer config.initialCacheTime is not defined.");if(!t.sessionId)throw new Error("O11y RUM: RumGZIPTransformer config.sessionId is not defined.");this.logger=t.logger||o.default,this.cache={},this.cacheTime=t.cacheTime,this.initialCacheTime=t.initialCacheTime,this.isInitial=!0,this.startTime=t.startTime,this.sessionId=t.sessionId,this.exportAndClearByKey=this.exportAndClearByKey.bind(this)}return t=e,(r=[{key:"process",value:function(e,t,r){var n=this;if(e)if(e.tags)if(t)if(r)if("function"==typeof r){var o=f(e.tags);o.sessionId=this.sessionId;var a,i=function(e){var t="";return Object.keys(e).sort().forEach((function(r){t="".concat(t,"-").concat(e[r])})),t}(o);this.cache[i]?(a=this.cache[i].dataSet,a=this.transform(e,t,a),this.cache[i]=s(s({},this.cache[i]),{},{dataSet:a})):(a={version:"1",rumInitializationEpoch:this.startTime,tags:o,resourceTimings:[],oobMetrics:[],markMeasures:[]},a=this.transform(e,t,a),this.cache[i]={dataSet:a,dataCallback:r},setTimeout((function(){n.exportAndClearByKey(i)}),this.isInitial?this.initialCacheTime:this.cacheTime),this.isInitial=!1)}else this.logger.error("O11y RUM: RumGZIPTransformer invalid dataCallback for transform");else this.logger.error("O11y RUM: RumGZIPTransformer missing dataCallback for transform");else this.logger.error("O11y RUM: RumGZIPTransformer missing dataType for transform");else this.logger.error("O11y RUM: RumGZIPTransformer missing data tags for transform");else this.logger.error("O11y RUM: RumGZIPTransformer missing data for transform")}},{key:"exportAndClearByKey",value:function(e){var t=this.cache[e],r=t.dataSet,o=t.dataCallback,a=JSON.stringify(r);console.log("Net call raw:",r),o(n.default.gzip(a),u),delete this.cache[e]}},{key:"transform",value:function(e,t,r){var n,o,a,i=s({},r);switch(t){case"mark-measure":n={name:(a=e).metricName,startUnixEpoch:a.start,endUnixEpoch:a.end,derivedMetricMMDuration:a.end-a.start,additionalTags:f(a.additionalTags)},i.markMeasures.push(n);break;case"navigation":n=function(e){var t=e.entry;return{name:t.name,entryType:t.entryType,startTime:t.startTime,duration:t.duration,initiatorType:t.initiatorType,nextHopProtocol:t.nextHopProtocol,workerStart:t.workerStart,redirectStart:t.redirectStart,redirectEnd:t.redirectEnd,fetchStart:t.fetchStart,domainLookupStart:t.domainLookupStart,domainLookupEnd:t.domainLookupEnd,connectStart:t.connectStart,connectEnd:t.connectEnd,secureConnectionStart:t.secureConnectionStart,requestStart:t.requestStart,responseStart:t.responseStart,responseEnd:t.responseEnd,transferSize:t.transferSize,encodedBodySize:t.encodedBodySize,decodedBodySize:t.decodedBodySize,unloadEventStart:t.unloadEventStart,unloadEventEnd:t.unloadEventEnd,domInteractive:t.domInteractive,domContentLoadedEventStart:t.domContentLoadedEventStart,domContentLoadedEventEnd:t.domContentLoadedEventEnd,domComplete:t.domComplete,loadEventStart:t.loadEventStart,loadEventEnd:t.loadEventEnd,type:t.type,redirectCount:t.redirectCount,navigationStart:t.navigationStart}}(e),i.navigationTiming=n;break;case"resource":n=function(e){var t=e.entries,r=[];return t.forEach((function(e){r.push({name:e.name,entryType:e.entryType,startTime:e.startTime,duration:e.duration,initiatorType:e.initiatorType,nextHopProtocol:e.nextHopProtocol,workerStart:e.workerStart,redirectStart:e.redirectStart,redirectEnd:e.redirectEnd,fetchStart:e.fetchStart,domainLookupStart:e.domainLookupStart,domainLookupEnd:e.domainLookupEnd,connectStart:e.connectStart,connectEnd:e.connectEnd,secureConnectionStart:e.secureConnectionStart,requestStart:e.requestStart,responseStart:e.responseStart,responseEnd:e.responseEnd,transferSize:e.transferSize,encodedBodySize:e.encodedBodySize,decodedBodySize:e.decodedBodySize})})),r}(e),i.resourceTimings=i.resourceTimings.concat(n);break;case"oob-metric":n={metricsType:l(o=e),value:o.value},i.oobMetrics.push(n);break;default:this.logger.error("O11y RUM: RumGZIPTransformer not a valid dataType to transform the data",t)}return i}}])&&d(t.prototype,r),a&&d(t,a),e;var t,r,a}();r.default=m,e.exports=t.default})?n.apply(t,o):n)||(e.exports=a)}}]);